# **Документация по установке и настройке сервера API**

## **Требования**

Перед началом убедитесь, что на вашем компьютере установлены следующие инструменты:

1. **Node.js** (рекомендуемая версия: LTS) и **npm** (устанавливается вместе с Node.js).
2. **TypeScript** (устанавливается через зависимости проекта).
3. **PostgreSQL** (или другой поддерживаемый базой данных).
4. **Git** (для клонирования репозитория).

---

## **Установка проекта**

1. **Клонирование репозитория** Склонируйте проект на локальную машину:
   
   ```bash
   git clone https://github.com/Black-Jack/server_api.git
   cd server_api
   ```

2. **Установка зависимостей** Установите все необходимые зависимости с помощью `npm`:
   
   ```bash
   npm install
   ```

3. **Создание файла `.env`** Скопируйте пример файла конфигурации:
   
   ```bash
   cp .env.example .env
   ```
   
   Отредактируйте файл `.env`, указав настройки для базы данных, порт сервера и другие параметры.

4. **Генерация типов для `.env`** Сгенерируйте типы для переменных окружения:
   
   ```bash
   npm run gen-env
   ```

---

## **Режим разработки**

### 1. **Запуск TypeScript-сервера**

Для запуска сервера в режиме разработки с использованием TypeScript выполните:

```bash
npm run devTS
```

Этот скрипт использует `nodemon` для автоматического перезапуска сервера при изменении файлов.

### 2. **Дополнительные команды**

- Для запуска тестов:
  
  ```bash
  npm run test
  ```

- Для просмотра миграций:
  
  ```bash
  npm run typeorm:show
  ```

---

## **Сборка и запуск в режиме релиза**

### 1. **Сборка проекта**

Выполните сборку TypeScript-кода в JavaScript:

```bash
npm run build
```

После этого скомпилированные файлы появятся в папке `dist`.

### 2. **Выполнение миграций**

Убедитесь, что база данных настроена, и выполните миграции:

```bash
npm run migration:run
```

### 3. **Запуск сервера**

Запустите сервер в режиме релиза:

```bash
npm run start
```

---

## **Полезные команды**

- **Генерация новой миграции:**
  
  ```bash
  npm run migration:generate -- -n MigrationName
  ```

- **Откат миграции:**
  
  ```bash
  npm run migration:revert
  ```

---

## **Проблемы и их решения**

1. **Ошибка подключения к базе данных:**
   
   - Проверьте параметры в файле `.env` (например, `DB_HOST`, `DB_USER`, `DB_PASSWORD`, `DB_NAME`).
   - Убедитесь, что PostgreSQL запущен.

2. **Команда `typeorm` не работает:**
   
   - Убедитесь, что файл `dist/data-source.js` существует после сборки.

3. **Ошибка с зависимостями:**
   
   - Установите недостающие пакеты:
     
     ```bash
     npm install
     ```

---

Это базовая версия документации для сервера API. Если нужно больше деталей (например, описания переменных `.env` или подробное описание каждого скрипта), напишите, и я добавлю!
